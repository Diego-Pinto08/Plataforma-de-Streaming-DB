CREATE TABLE movies (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    director VARCHAR(255) NOT NULL,
    principal_actor VARCHAR(255) NOT NULL,
    genre VARCHAR(100),
    year INT CHECK (year > 1800 AND year <= EXTRACT(YEAR FROM CURRENT_DATE)),
    duration INT CHECK (duration > 0)
);